<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ACH File Parser</title>
    <style>
        body {
            font-family: Arial, Helvetica, sans-serif;
        }
        .container {
            max-width: 1024px;
            min-width: 800px;
            margin: 0 auto;
            padding: 20px;
        }
        .field {
            margin-bottom: 10px;
        }
        .field label {
            display: block;
            margin-bottom: 5px;
        }
        .field input, .field textarea {
            width: 100%;
            padding: 8px;
            box-sizing: border-box;
        }
        .row {
            display: flex;
            flex-wrap: wrap;
        }
        .row .field {
            flex: 1;
            min-width: 200px;
            margin-right: 10px;
        }
        .row .field:last-child {
            margin-right: 0;
        }
        .collapsible {
            background-color: #f1f1f1;
            cursor: pointer;
            padding: 10px;
            width: 100%;
            border: none;
            text-align: left;
            outline: none;
            font-size: 15px;
        }
        .active, .collapsible:hover {
            background-color: #ccc;
        }
        .content {
            padding: 0 18px;
            display: none;
            overflow: hidden;
            background-color: #f9f9f9;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ACH File Parser</h1>
        <div class="field">
            <label for="achFileContent">ACH File Content (domestic only atm):</label>
            <textarea id="achFileContent" rows="10"></textarea>
        </div>
        <button onclick="parseAchFile()">Parse</button>
        <h2>Parsed Information</h2>
        <div id="parsedInfo"></div>
    </div>
    <script>
        function parseAchFile() {
            const achFileContent = document.getElementById('achFileContent').value;
            const lines = achFileContent.split('\n');
            const parsedInfo = document.getElementById('parsedInfo');
            parsedInfo.innerHTML = '';

            let groupContent = null;
            let batchCount = 0;

            lines.forEach((line, index) => {
                if (line.trim() === '' || /^9+$/.test(line)) return;

                const recordType = line.substring(0, 1);
                const row = document.createElement('div');
                row.className = 'row';

                if (recordType === '1') {
                    const header = document.createElement('h3');
                    header.textContent = 'File Header Record';
                    parsedInfo.appendChild(header);

                    row.innerHTML = `
                        <div class="field">
                            <label>Record Type Code:</label>
                            <input type="text" value="${line.substring(0, 1)}" readonly>
                        </div>
                        <div class="field">
                            <label>Priority Code:</label>
                            <input type="text" value="${line.substring(1, 3)}" readonly>
                        </div>
                        <div class="field">
                            <label>Immediate Destination:</label>
                            <input type="text" value="${line.substring(3, 13).trim()}" readonly>
                        </div>
                        <div class="field">
                            <label>Immediate Origin:</label>
                            <input type="text" value="${line.substring(13, 23).trim()}" readonly>
                        </div>
                        <div class="field">
                            <label>File Creation Date:</label>
                            <input type="text" value="${line.substring(23, 29)}" readonly>
                        </div>
                        <div class="field">
                            <label>File Creation Time:</label>
                            <input type="text" value="${line.substring(29, 33)}" readonly>
                        </div>
                        <div class="field">
                            <label>File ID Modifier:</label>
                            <input type="text" value="${line.substring(33, 34)}" readonly>
                        </div>
                        <div class="field">
                            <label>Record Size:</label>
                            <input type="text" value="${line.substring(34, 37)}" readonly>
                        </div>
                        <div class="field">
                            <label>Blocking Factor:</label>
                            <input type="text" value="${line.substring(37, 39)}" readonly>
                        </div>
                        <div class="field">
                            <label>Format Code:</label>
                            <input type="text" value="${line.substring(39, 40)}" readonly>
                        </div>
                        <div class="field">
                            <label>Immediate Destination Name:</label>
                            <input type="text" value="${line.substring(40, 63).trim()}" readonly>
                        </div>
                        <div class="field">
                            <label>Immediate Origin Name:</label>
                            <input type="text" value="${line.substring(63, 86).trim()}" readonly>
                        </div>
                        <div class="field">
                            <label>Reference Code:</label>
                            <input type="text" value="${line.substring(86, 94).trim()}" readonly>
                        </div>
                    `;
                } else if (recordType === '5' || recordType === '6' || recordType === '8') {
                    if (!groupContent) {
                        batchCount++;
                        const groupHeader = document.createElement('h3');
                        groupHeader.textContent = `Batch ${batchCount}`;
                        parsedInfo.appendChild(groupHeader);

                        const groupButton = document.createElement('button');
                        groupButton.className = 'collapsible';
                        groupButton.innerText = `Batch Records (5, 6, 8) - Batch ${batchCount}`;
                        groupButton.onclick = function() {
                            this.classList.toggle('active');
                            const content = this.nextElementSibling;
                            if (content.style.display === 'block') {
                                content.style.display = 'none';
                            } else {
                                content.style.display = 'block';
                            }
                        };
                        parsedInfo.appendChild(groupButton);

                        groupContent = document.createElement('div');
                        groupContent.className = 'content';
                        parsedInfo.appendChild(groupContent);
                    }

                    if (recordType === '5') {
                        const header = document.createElement('h4');
                        header.textContent = 'Batch Header Record';
                        groupContent.appendChild(header);

                        row.innerHTML = `
                            <div class="field">
                                <label>Record Type Code:</label>
                                <input type="text" value="${line.substring(0, 1)}" readonly>
                            </div>
                            <div class="field">
                                <label>Service Class Code:</label>
                                <input type="text" value="${line.substring(1, 4)}" readonly>
                            </div>
                            <div class="field">
                                <label>Company Name:</label>
                                <input type="text" value="${line.substring(4, 20).trim()}" readonly>
                            </div>
                            <div class="field">
                                <label>Company Discretionary Data:</label>
                                <input type="text" value="${line.substring(20, 40).trim()}" readonly>
                            </div>
                            <div class="field">
                                <label>Company Identification:</label>
                                <input type="text" value="${line.substring(40, 50).trim()}" readonly>
                            </div>
                            <div class="field">
                                <label>Standard Entry Class Code:</label>
                                <input type="text" value="${line.substring(50, 53).trim()}" readonly>
                            </div>
                            <div class="field">
                                <label>Company Entry Description:</label>
                                <input type="text" value="${line.substring(53, 63).trim()}" readonly>
                            </div>
                            <div class="field">
                                <label>Company Descriptive Date:</label>
                                <input type="text" value="${line.substring(63, 69).trim()}" readonly>
                            </div>
                            <div class="field">
                                <label>Effective Entry Date:</label>
                                <input type="text" value="${line.substring(69, 75).trim()}" readonly>
                            </div>
                            <div class="field">
                                <label>Settlement Date:</label>
                                <input type="text" value="${line.substring(75, 78).trim()}" readonly>
                            </div>
                            <div class="field">
                                <label>Originator Status Code:</label>
                                <input type="text" value="${line.substring(78, 79).trim()}" readonly>
                            </div>
                            <div class="field">
                                <label>Originating DFI Identification:</label>
                                <input type="text" value="${line.substring(79, 87).trim()}" readonly>
                            </div>
                            <div class="field">
                                <label>Batch Number:</label>
                                <input type="text" value="${line.substring(87, 94).trim()}" readonly>
                            </div>
                        `;
                    } else if (recordType === '6') {
                        const header = document.createElement('h4');
                        header.textContent = 'Entry Record';
                        groupContent.appendChild(header);

                        row.innerHTML = `
                            <div class="field">
                                <label>Record Type Code:</label>
                                <input type="text" value="${line.substring(0, 1)}" readonly>
                            </div>
                            <div class="field">
                                <label>Transaction Code:</label>
                                <input type="text" value="${line.substring(1, 3)}" readonly>
                            </div>
                            <div class="field">
                                <label>Receiving DFI Identification:</label>
                                <input type="text" value="${line.substring(3, 11)}" readonly>
                            </div>
                            <div class="field">
                                <label>Check Digit:</label>
                                <input type="text" value="${line.substring(11, 12)}" readonly>
                            </div>
                            <div class="field">
                                <label>DFI Account Number:</label>
                                <input type="text" value="${line.substring(12, 29).trim()}" readonly>
                            </div>
                            <div class="field">
                                <label>Amount:</label>
                                <input type="text" value="${line.substring(29, 39).trim()}" readonly>
                            </div>
                            <div class="field">
                                <label>Identification (reference):</label>
                                <input type="text" value="${line.substring(39, 54).trim()}" readonly>
                            </div>
                            <div class="field">
                                <label>Individual Name:</label>
                                <input type="text" value="${line.substring(54, 75).trim()}" readonly>
                            </div>
                            <div class="field">
                                <label>Discretionary data:</label>
                                <input type="text" value="${line.substring(75, 78).trim()}" readonly>
                            </div>
                            <div class="field">
                                <label>Addenda Record Indicator:</label>
                                <input type="text" value="${line.substring(78, 79).trim()}" readonly>
                            </div>
                            <div class="field">
                                <label>Trace Number:</label>
                                <input type="text" value="${line.substring(79, 94).trim()}" readonly>
                            </div>
                        `;
                    } else if (recordType === '8') {
                        const header = document.createElement('h4');
                        header.textContent = 'Batch Control Record';
                        groupContent.appendChild(header);

                        row.innerHTML = `
                            <div class="field">
                                <label>Record Type Code:</label>
                                <input type="text" value="${line.substring(0, 1)}" readonly>
                            </div>
                            <div class="field">
                                <label>Service Class Code:</label>
                                <input type="text" value="${line.substring(1, 4)}" readonly>
                            </div>
                            <div class="field">
                                <label>Entry/Addenda Count:</label>
                                <input type="text" value="${line.substring(4, 10).trim()}" readonly>
                            </div>
                            <div class="field">
                                <label>Entry Hash:</label>
                                <input type="text" value="${line.substring(10, 20).trim()}" readonly>
                            </div>
                            <div class="field">
                                <label>Total Debit Entry Dollar Amount:</label>
                                <input type="text" value="${line.substring(20, 32).trim()}" readonly>
                            </div>
                            <div class="field">
                                <label>Total Credit Entry Dollar Amount:</label>
                                <input type="text" value="${line.substring(32, 44).trim()}" readonly>
                            </div>
                            <div class="field">
                                <label>Company Identification:</label>
                                <input type="text" value="${line.substring(44, 54).trim()}" readonly>
                            </div>
                            <div class="field">
                                <label>Message Authentication Code:</label>
                                <input type="text" value="${line.substring(54, 73).trim()}" readonly>
                            </div>
                            <div class="field">
                                <label>Reserved:</label>
                                <input type="text" value="${line.substring(73, 79).trim()}" readonly>
                            </div>
                            <div class="field">
                                <label>Originating DFI Identification:</label>
                                <input type="text" value="${line.substring(79, 87).trim()}" readonly>
                            </div>
                            <div class="field">
                                <label>Batch Number:</label>
                                <input type="text" value="${line.substring(87, 94).trim()}" readonly>
                            </div>
                        `;
                    }

                    groupContent.appendChild(row);
                    if (recordType === '8') {
                        // reset the group fro the batch if batch control record was processed
                        groupContent = null;
                    }
                } else if (recordType === '9') {
                    const header = document.createElement('h3');
                    header.textContent = 'File Control Record';
                    parsedInfo.appendChild(header);

                    row.innerHTML = `
                        <div class="field">
                            <label>Record Type Code:</label>
                            <input type="text" value="${line.substring(0, 1)}" readonly>
                        </div>
                        <div class="field">
                            <label>Batch Count:</label>
                            <input type="text" value="${line.substring(1, 7).trim()}" readonly>
                        </div>
                        <div class="field">
                            <label>Block Count:</label>
                            <input type="text" value="${line.substring(7, 13).trim()}" readonly>
                        </div>
                        <div class="field">
                            <label>Entry/Addenda Count:</label>
                            <input type="text" value="${line.substring(13, 21).trim()}" readonly>
                        </div>
                        <div class="field">
                            <label>Entry Hash:</label>
                            <input type="text" value="${line.substring(21, 31).trim()}" readonly>
                        </div>
                        <div class="field">
                            <label>Total Debit Entry Dollar Amount:</label>
                            <input type="text" value="${line.substring(31, 43).trim()}" readonly>
                        </div>
                        <div class="field">
                            <label>Total Credit Entry Dollar Amount:</label>
                            <input type="text" value="${line.substring(43, 55).trim()}" readonly>
                        </div>
                        <div class="field">
                            <label>Reserved:</label>
                            <input type="text" value="${line.substring(55, 94).trim()}" readonly>
                        </div>
                    `;
                }

                if (recordType !== '5' && recordType !== '6' && recordType !== '8') {
                    parsedInfo.appendChild(row);
                }
            });
        }
    </script>
</body>
</html>
